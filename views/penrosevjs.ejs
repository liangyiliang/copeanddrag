<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Penrose Generated Visualization</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </head>
  <body>
    <!--
    JSPM Generator Import Map
    Edit URL: https://generator.jspm.io/#U2VhYGBkTM4vSmVwKEjNK8ovTtUH8RyM9Qz0DAA+kyABHgA
  -->
    <script type="importmap">
      {
        "imports": {
          "@penrose/core": "https://ga.jspm.io/npm:@penrose/core@3.2.0/dist/index.js"
        },
        "scopes": {
          "https://ga.jspm.io/": {
            "@datastructures-js/queue": "https://ga.jspm.io/npm:@datastructures-js/queue@4.2.3/index.js",
            "@penrose/optimizer": "https://ga.jspm.io/npm:@penrose/optimizer@3.2.0/dist/index.js",
            "consola": "https://ga.jspm.io/npm:consola@2.15.3/dist/consola.browser.js",
            "crypto": "https://ga.jspm.io/npm:@jspm/core@2.0.1/nodelibs/browser/crypto.js",
            "immutable": "https://ga.jspm.io/npm:immutable@4.3.1/dist/immutable.es.js",
            "lodash": "https://ga.jspm.io/npm:lodash@4.17.21/lodash.js",
            "mathjax-full/js/": "https://ga.jspm.io/npm:mathjax-full@3.2.2/js/",
            "mhchemparser/dist/mhchemParser.js": "https://ga.jspm.io/npm:mhchemparser@4.2.1/dist/mhchemParser.js",
            "moo": "https://ga.jspm.io/npm:moo@0.5.2/moo.js",
            "nearley": "https://ga.jspm.io/npm:nearley@2.20.1/lib/nearley.js",
            "poly-partition": "https://ga.jspm.io/npm:poly-partition@1.0.2/lib/index.js",
            "seedrandom": "https://ga.jspm.io/npm:seedrandom@3.0.5/index.js",
            "true-myth": "https://ga.jspm.io/npm:true-myth@4.1.1/dist/cjs/index.js"
          }
        }
      }
    </script>

    <!-- ES Module Shims: Import maps polyfill for olrder browsers without import maps support (eg Safari 16.3) -->
    <script
      async
      src="https://ga.jspm.io/npm:es-module-shims@1.7.3/dist/es-module-shims.js"
      crossorigin="anonymous"
    ></script>

    <script type="module">
      import { compile, optimize, toSVG, showError } from "@penrose/core";
      const trio = {
        substance:   `<%- substance %>`,
        domain:  `<%- domain %>`,
        style:  `<%- style %>`,
        variation: `test`  // What is this?
      };
      const compiled = await compile(trio);
      if (compiled.isErr()) console.error(showError(compiled.error));
      const optimized = optimize(compiled.value);
      if (optimized.isErr()) console.error(showError(optimized.error));
      document
        .getElementById("penrose")
        .appendChild(await toSVG(optimized.value));
    </script>



    <div class="container">
      <div id="penrose"></div>
    </div>

    <hr>
    
    <!-- <div id="domainfile">
      <h3> .domain</h3>
      <pre><%- domain %></pre>
    </div>

    <hr>
    <div id="stylefile">
      <h3> .style</h3>
      <pre><%- style %></pre>

    </div>
    <hr>
    <div id="substancefile">
      <h3> .substance</h3>
      <pre><%- substance %></pre>
    </div> -->

    <div class="accordion" id="accordionExample">

      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            .domain
          </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <pre><%- domain %></pre>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingTwo">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
            .style
          </button>
        </h2>
        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <pre><%- style %></pre>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingThree">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
            .substance
          </button>
        </h2>
        <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <pre><%- substance %></pre>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
